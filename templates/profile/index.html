{% extends 'base.html' %}
{% load static %}

{% block title %}Profile - Ralfiz BMS{% endblock %}

{% block breadcrumb %}
<a href="{% url 'dashboard' %}" class="breadcrumb-item">Dashboard</a>
<span class="breadcrumb-separator">/</span>
<span class="breadcrumb-item active">Profile</span>
{% endblock %}

{% block content %}
<div class="page-header">
  <div>
    <h1 class="page-title">My Profile</h1>
    <p class="page-subtitle mb-0">Manage your account settings</p>
  </div>
</div>

<div class="row">
  <!-- Profile Info -->
  <div class="col-6 col-md-12" style="padding: 0.75rem;">
    <div class="card">
      <div class="card-header">
        <h3 class="card-title">
          <i class="fas fa-user me-2 text-primary"></i>
          Profile Information
        </h3>
      </div>
      <form method="post">
        {% csrf_token %}
        <div class="card-body">
          <div class="row">
            <div class="col-6 col-sm-12" style="padding: 0.5rem;">
              <div class="form-group">
                <label class="form-label">First Name</label>
                <input type="text" class="form-control" name="first_name" value="{{ profile_user.first_name|default:'' }}">
              </div>
            </div>
            <div class="col-6 col-sm-12" style="padding: 0.5rem;">
              <div class="form-group">
                <label class="form-label">Last Name</label>
                <input type="text" class="form-control" name="last_name" value="{{ profile_user.last_name|default:'' }}">
              </div>
            </div>
            <div class="col-6 col-sm-12" style="padding: 0.5rem;">
              <div class="form-group">
                <label class="form-label">Username</label>
                <input type="text" class="form-control" value="{{ profile_user.username }}" disabled>
                <div class="form-text">Username cannot be changed</div>
              </div>
            </div>
            <div class="col-6 col-sm-12" style="padding: 0.5rem;">
              <div class="form-group">
                <label class="form-label">Email</label>
                <input type="email" class="form-control" name="email" value="{{ profile_user.email|default:'' }}">
              </div>
            </div>
          </div>
        </div>
        <div class="card-footer d-flex justify-content-end">
          <button type="submit" class="btn btn-primary">
            <i class="fas fa-save me-2"></i>Save Changes
          </button>
        </div>
      </form>
    </div>
  </div>

  <!-- Change Password -->
  <div class="col-6 col-md-12" style="padding: 0.75rem;">
    <div class="card">
      <div class="card-header">
        <h3 class="card-title">
          <i class="fas fa-lock me-2 text-primary"></i>
          Change Password
        </h3>
      </div>
      <form method="post" action="{% url 'change_password' %}">
        {% csrf_token %}
        <div class="card-body">
          <div class="form-group mb-3">
            <label class="form-label">Current Password</label>
            <input type="password" class="form-control" name="current_password" required>
          </div>
          <div class="form-group mb-3">
            <label class="form-label">New Password</label>
            <input type="password" class="form-control" name="new_password" required minlength="8">
            <div class="form-text">Minimum 8 characters</div>
          </div>
          <div class="form-group mb-0">
            <label class="form-label">Confirm New Password</label>
            <input type="password" class="form-control" name="confirm_password" required minlength="8">
          </div>
        </div>
        <div class="card-footer d-flex justify-content-end">
          <button type="submit" class="btn btn-warning">
            <i class="fas fa-key me-2"></i>Change Password
          </button>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- Account Info -->
<div class="row">
  <div class="col-12" style="padding: 0.75rem;">
    <div class="card">
      <div class="card-header">
        <h3 class="card-title">
          <i class="fas fa-info-circle me-2 text-primary"></i>
          Account Information
        </h3>
      </div>
      <div class="card-body">
        <div class="row">
          <div class="col-3 col-md-6 col-sm-12" style="padding: 0.5rem;">
            <div class="text-sm text-muted mb-1">Account Created</div>
            <div class="fw-medium">{{ profile_user.date_joined|date:"d F Y, h:i A" }}</div>
          </div>
          <div class="col-3 col-md-6 col-sm-12" style="padding: 0.5rem;">
            <div class="text-sm text-muted mb-1">Last Login</div>
            <div class="fw-medium">{{ profile_user.last_login|date:"d F Y, h:i A"|default:"Never" }}</div>
          </div>
          <div class="col-3 col-md-6 col-sm-12" style="padding: 0.5rem;">
            <div class="text-sm text-muted mb-1">Account Status</div>
            <div>
              {% if profile_user.is_active %}
              <span class="status-badge active">Active</span>
              {% else %}
              <span class="status-badge cancelled">Inactive</span>
              {% endif %}
            </div>
          </div>
          <div class="col-3 col-md-6 col-sm-12" style="padding: 0.5rem;">
            <div class="text-sm text-muted mb-1">Role</div>
            <div class="fw-medium">
              {% if profile_user.is_superuser %}Administrator{% elif profile_user.is_staff %}Staff{% else %}User{% endif %}
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}
